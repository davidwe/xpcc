<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>XPCC: 3. Build system</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">XPCC
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('build_system.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">3. Build system </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>XPCC uses SCons (a Python-based build tool) instead of the tradional approach with Make.</p>
<p>Chosen for its cross-platform capabilities and extendebility SCons has proven to be a worthy replacement.</p>
<h2><a class="anchor" id="what"></a>
What is SCons?</h2>
<p>It is Open Source software using Python scripts as configuration files. The SConstruct files are the equivalent of Makefiles, they define the targets that SCons will create during the build process.</p>
<p>For more details see on SCons see:</p>
<ul>
<li>SCons documentation: <a href="http://www.scons.org/documentation.php">http://www.scons.org/documentation.php</a></li>
<li>Good Overview: <a href="http://www.humanized.com/presentations/scons/">http://www.humanized.com/presentations/scons/</a></li>
</ul>
<h2><a class="anchor" id="usage"></a>
Usage</h2>
<p>Like a Makefile you need a SConstruct file in jour project, which holds description about where to find and how to build the needed sourcefiles. Aditionally the buildprocess can be modified by configuration files.</p>
<p>About how to create SConstruct files and the project/build configuration read in their own documentation pages:</p>
<ul>
<li><a class="el" href="sconstruct_template.html">Universal SConstruct template</a></li>
<li><a class="el" href="sconstruct.html">SConstruct files: An introduction</a></li>
<li><a class="el" href="sconstruct_advanced.html">SConstruct files: Advanced topics</a></li>
<li><a class="el" href="scons_tools.html">SCons Tools</a></li>
<li><a class="el" href="configuration_files.html">Configuration files</a></li>
</ul>
<p>To initiate the build process execute scons in the manner described below.</p>
<p>The default command is: </p>
<div class="fragment"><pre class="fragment">
$ scons
</pre></div><p> This will build all default targets for the current folder.</p>
<p>When you for example include SCons in Eclipse it might be needed to run SCons in a different folder. This can be achieved with the <code>-C</code> parameter: </p>
<div class="fragment"><pre class="fragment">
$ scons -C path/to/other/folder
</pre></div><p>It should be almost never needed, but if you need to remove all temporary and otherwise created files use: </p>
<div class="fragment"><pre class="fragment">
$ scons -c
</pre></div><p>Get help about the command-line targets: </p>
<div class="fragment"><pre class="fragment">
scons -h
</pre></div><p>These help messages have been programmed into the SConstruct files for XPCC. They are not written or supported by the SCons developers. To see the options that are written and supported by the SCons developers you need to issue the command</p>
<div class="fragment"><pre class="fragment">
scons -H
</pre></div><p>By default SCons will stop compilation after the first error it encounters, but one can tell SCons to continue building after it encounters an error. To do this you append the <code>-i</code> option to the SCons command.</p>
<h3><a class="anchor" id="other"></a>
Other useful options</h3>
<p>Per default SCons won't print the complete compiler commandline, but only something like: </p>
<div class="fragment"><pre class="fragment">
...
Compiling C++: build/xpcc/math/geometry/test/point_set_2d_test.o
Compiling C++: build/xpcc/math/geometry/test/polygon_2d_test.o
Compiling C++: build/xpcc/math/geometry/test/angle_test.o
Compiling C++: build/xpcc/math/geometry/test/location_2d_test.o
Compiling C++: build/xpcc/math/geometry/test/vector_2d_test.o
Compiling C++: build/xpcc/math/geometry/test/line_segment_2d_test.o
Compiling C++: build/xpcc/math/geometry/test/line_2d_test.o
Compiling C++: build/xpcc/math/saturated/test/saturated_test.o
....
</pre></div><p>To enable the complete output the parameter <code>verbose</code> is available. The following will print the exact commands being executed: </p>
<div class="fragment"><pre class="fragment">
scons verbose=1
</pre></div><p>This will result in something like this for example above: </p>
<div class="fragment"><pre class="fragment">
...
g++ -o build/xpcc/math/geometry/test/point_set_2d_test.o -c -std=gnu++98 -Woverloaded-virtual -funsigned-char -funsigned-bitfields -Wall -Wextra -Wundef -ggdb -I. xpcc/math/geometry/test/point_set_2d_test.cpp
g++ -o build/xpcc/math/geometry/test/polygon_2d_test.o -c -std=gnu++98 -Woverloaded-virtual -funsigned-char -funsigned-bitfields -Wall -Wextra -Wundef -ggdb -I. xpcc/math/geometry/test/polygon_2d_test.cpp
g++ -o build/xpcc/math/geometry/test/angle_test.o -c -std=gnu++98 -Woverloaded-virtual -funsigned-char -funsigned-bitfields -Wall -Wextra -Wundef -ggdb -I. xpcc/math/geometry/test/angle_test.cpp
g++ -o build/xpcc/math/geometry/test/location_2d_test.o -c -std=gnu++98 -Woverloaded-virtual -funsigned-char -funsigned-bitfields -Wall -Wextra -Wundef -ggdb -I. xpcc/math/geometry/test/location_2d_test.cpp
g++ -o build/xpcc/math/geometry/test/vector_2d_test.o -c -std=gnu++98 -Woverloaded-virtual -funsigned-char -funsigned-bitfields -Wall -Wextra -Wundef -ggdb -I. xpcc/math/geometry/test/vector_2d_test.cpp
g++ -o build/xpcc/math/geometry/test/line_segment_2d_test.o -c -std=gnu++98 -Woverloaded-virtual -funsigned-char -funsigned-bitfields -Wall -Wextra -Wundef -ggdb -I. xpcc/math/geometry/test/line_segment_2d_test.cpp
g++ -o build/xpcc/math/geometry/test/line_2d_test.o -c -std=gnu++98 -Woverloaded-virtual -funsigned-char -funsigned-bitfields -Wall -Wextra -Wundef -ggdb -I. xpcc/math/geometry/test/line_2d_test.cpp
g++ -o build/xpcc/math/saturated/test/saturated_test.o -c -std=gnu++98 -Woverloaded-virtual -funsigned-char -funsigned-bitfields -Wall -Wextra -Wundef -ggdb -I. xpcc/math/saturated/test/saturated_test.cpp
...
</pre></div><p>This is far less readable but can show if something is wrong with the invoking of the compiler etc.</p>
<p>This page should help to explain why we choose SCons as our main build system.</p>
<p><code>make</code> is the older and far more wide-spread tool to build software. If you do some programming, you almost certain have some kind of make installed on your Computer.</p>
<p>But there is another side to that problem: While developing the software for our robot we don't have one big project but have to change between different small pojects. We use a about 10 to 30 microcontrollers within the robot with at least three to four different types. So we have to make sure that every time we change to the next project, and something was change within the library, everything has to be rebuild for the new project as it might use a different microcontroller.</p>
<p>This is a very weak point of make. It can't notize a change in the project configuration (and therefore the build parameters) and will rebuild A file only baseD on the date of source and object file. Therefore a manual 'make clean &amp;&amp; make all' step is nessesary in that case. This is not only very annoying but also very error-prone. In the worst case the build will run smoothly but the microcontroller will do weird stuff. In our previous build system we used make and ran into this problem quite often.</p>
<p>This then became the main reason why we choose SCons and moved away from Make. SCons is capable to track which object file was build with which options and to rebuild it when the options change. This makes the manual 'make clean' step unnecessary and ensures that every object file is build for the correct microcontroller. </p>
</div></div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="index.html">Cross Platform Component Communication</a>      </li>
<hr class="footer" />
<address class="footer"><small>Generated on Mon Mar 5 2012 21:26:00 for XPCC by&nbsp;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.png" alt="doxygen" border="0" /></a> 1.7.6.1</small></address>

<!-- Piwik -->
<script type="text/javascript">
var pkBaseURL = (("https:" == document.location.protocol) ? "https://sourceforge.net/apps/piwik/xpcc/" : "http://sourceforge.net/apps/piwik/xpcc/");
document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
</script>

<script type="text/javascript">
try {
	var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 1);
	piwikTracker.trackPageView();
	piwikTracker.enableLinkTracking();
} catch( err ) {}
</script>
<noscript>
<p><img src="http://sourceforge.net/apps/piwik/xpcc/piwik.php?idsite=1" style="border:0" alt=""/></p>
</noscript>
<!-- End Piwik Tag -->

</body>
</html>
