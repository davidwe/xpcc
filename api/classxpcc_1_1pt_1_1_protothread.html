<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>XPCC: xpcc::pt::Protothread Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">XPCC
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('classxpcc_1_1pt_1_1_protothread.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-types">Protected Types</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pro-static-attribs">Static Protected Attributes</a>  </div>
  <div class="headertitle">
<div class="title">xpcc::pt::Protothread Class Reference<div class="ingroups"><a class="el" href="group__protothread.html">Protothreads</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="xpcc::pt::Protothread" -->
<p>A very lightweight, stackless thread.  
 <a href="classxpcc_1_1pt_1_1_protothread.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="protothread_2protothread_8hpp_source.html">xpcc/workflow/protothread/protothread.hpp</a>&gt;</code></p>

<p><a href="classxpcc_1_1pt_1_1_protothread-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a60c9acd2c0f6fe5cfe8f04c4c08b78f4"></a><!-- doxytag: member="xpcc::pt::Protothread::Protothread" ref="a60c9acd2c0f6fe5cfe8f04c4c08b78f4" args="()" -->
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classxpcc_1_1pt_1_1_protothread.html#a60c9acd2c0f6fe5cfe8f04c4c08b78f4">Protothread</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a new protothread that will start from the beginning of its <a class="el" href="classxpcc_1_1pt_1_1_protothread.html#a640728df919edbefe4c9cefa5c8be90c" title="Run the protothread.">run()</a> function. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3c9892ebfbed1112dd5a7dc8882c0e94"></a><!-- doxytag: member="xpcc::pt::Protothread::restart" ref="a3c9892ebfbed1112dd5a7dc8882c0e94" args="()" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classxpcc_1_1pt_1_1_protothread.html#a3c9892ebfbed1112dd5a7dc8882c0e94">restart</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Restart protothread. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classxpcc_1_1pt_1_1_protothread.html#a61c7c84a815782e69d7d0c33d76c4b9e">stop</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Stop the protothread from running.  <a href="#a61c7c84a815782e69d7d0c33d76c4b9e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classxpcc_1_1pt_1_1_protothread.html#a74d6c935ce548a93698d902420cbaab9">isRunning</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if the protothread is still running.  <a href="#a74d6c935ce548a93698d902420cbaab9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classxpcc_1_1pt_1_1_protothread.html#a640728df919edbefe4c9cefa5c8be90c">run</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Run the protothread.  <a href="#a640728df919edbefe4c9cefa5c8be90c"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pro-types"></a>
Protected Types</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac4410b68c3c9894c9056a1bbba46ad03"></a><!-- doxytag: member="xpcc::pt::Protothread::State" ref="ac4410b68c3c9894c9056a1bbba46ad03" args="" -->
typedef uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classxpcc_1_1pt_1_1_protothread.html#ac4410b68c3c9894c9056a1bbba46ad03">State</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Used to store a protothread's position (what Dunkels calls a "local continuation"). <br/></td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae2a9fc340b7d60d230010e5506c7d676"></a><!-- doxytag: member="xpcc::pt::Protothread::ptState" ref="ae2a9fc340b7d60d230010e5506c7d676" args="" -->
<a class="el" href="classxpcc_1_1pt_1_1_protothread.html#ac4410b68c3c9894c9056a1bbba46ad03">State</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classxpcc_1_1pt_1_1_protothread.html#ae2a9fc340b7d60d230010e5506c7d676">ptState</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Stores the protothread's position (by storing the line number of the last PT_WAIT, which is then switched on at the next Run). <br/></td></tr>
<tr><td colspan="2"><h2><a name="pro-static-attribs"></a>
Static Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3d87cc545a84f031b266d521c32d088f"></a><!-- doxytag: member="xpcc::pt::Protothread::Invalid" ref="a3d87cc545a84f031b266d521c32d088f" args="" -->
static const <a class="el" href="classxpcc_1_1pt_1_1_protothread.html#ac4410b68c3c9894c9056a1bbba46ad03">State</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classxpcc_1_1pt_1_1_protothread.html#a3d87cc545a84f031b266d521c32d088f">Invalid</a> = static_cast&lt;<a class="el" href="classxpcc_1_1pt_1_1_protothread.html#ac4410b68c3c9894c9056a1bbba46ad03">State</a>&gt;(-1)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">An invalid line number, used to mark the protothread has ended. <br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Because protothreads do not save the stack context across a blocking call, local variables are not preserved when the protothread blocks. This means that local variables should be used with utmost care - if in doubt, do not use local variables inside a protothread! Use private/protected member variables to save state between a context switch.</p>
<p>A protothread is driven by repeated calls to the <a class="el" href="classxpcc_1_1pt_1_1_protothread.html#a640728df919edbefe4c9cefa5c8be90c" title="Run the protothread.">run()</a>-function in which the protothread is running. Each time the function is called, the protothread will run until it blocks or exits. Thus the scheduling of protothreads is done by the application that uses protothreads.</p>
<p>Example: </p>
<div class="fragment"><pre class="fragment"><span class="preprocessor"> #include &lt;xpcc/architecture.hpp&gt;</span>
<span class="preprocessor"> #include &lt;xpcc/utils/protothread.hpp&gt;</span>
<span class="preprocessor"> #include &lt;xpcc/utils/timeout.hpp&gt;</span>
 
 <a class="code" href="group__gpio.html#ga847688ffd76ce21d6de2c904104b8b68" title="Create a output pin type.">GPIO__OUTPUT</a>(Led, B, 0);
 
 <span class="keyword">class </span>BlinkingLight : <span class="keyword">public</span> xpcc::pt::<a class="code" href="classxpcc_1_1pt_1_1_protothread.html#a60c9acd2c0f6fe5cfe8f04c4c08b78f4" title="Construct a new protothread that will start from the beginning of its run() function.">Protothread</a>
 {
 <span class="keyword">public</span>:
     <span class="keywordtype">bool</span>
     <a class="code" href="classxpcc_1_1pt_1_1_protothread.html#a640728df919edbefe4c9cefa5c8be90c" title="Run the protothread.">run</a>()
     {
         <a class="code" href="group__protothread.html#ga6da3471eb116970eb1dce79bfcc7cd3e" title="Declare start of protothread.">PT_BEGIN</a>();
         
         <span class="comment">// set everything up</span>
         Led::setOutput();
         Led::set();
         
         <span class="keywordflow">while</span> (<span class="keyword">true</span>)
         {
             this-&gt;timer.start(100);
             Led::set();
             <a class="code" href="group__protothread.html#ga742a4c6aa99440473f54651233ebd28b" title="Cause protothread to wait until given condition is true.">PT_WAIT_UNTIL</a>(this-&gt;timer.isExpired());
             
             this-&gt;timer.start(200);
             Led::reset();
             <a class="code" href="group__protothread.html#ga742a4c6aa99440473f54651233ebd28b" title="Cause protothread to wait until given condition is true.">PT_WAIT_UNTIL</a>(this-&gt;timer.isExpired());
         }
         
         <a class="code" href="group__protothread.html#ga146c4bb0e1f9f2020cd12b8dd7ff076e" title="Stop protothread and end it.">PT_END</a>();
     }
     
 <span class="keyword">private</span>:
     <a class="code" href="classxpcc_1_1_timeout.html" title="Software timer.">xpcc::Timeout&lt;&gt;</a> timer;
 };
 
 
 ...
 BlinkingLight light;
 
 <span class="keywordflow">while</span> (...) {
     light.run();
 }
</pre></div><p>For other examples take a look in the <code>examples</code> folder in the XPCC root folder.</p>
<dl class="warning"><dt><b>Warning:</b></dt><dd>The names <code>ptState</code> and <code>ptYield</code> are reserved and may not be used as variables or function names! </dd></dl>

<p>Definition at line <a class="el" href="protothread_2protothread_8hpp_source.html#l00112">112</a> of file <a class="el" href="protothread_2protothread_8hpp_source.html">protothread/protothread.hpp</a>.</p>
</div><hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a61c7c84a815782e69d7d0c33d76c4b9e"></a><!-- doxytag: member="xpcc::pt::Protothread::stop" ref="a61c7c84a815782e69d7d0c33d76c4b9e" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classxpcc_1_1pt_1_1_protothread.html#a61c7c84a815782e69d7d0c33d76c4b9e">xpcc::pt::Protothread::stop</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Happens automatically at PT_END.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>This differs from the Dunkels' original protothread behavior (his restart automatically, which is usually not what you want). </dd></dl>

<p>Definition at line <a class="el" href="protothread_2protothread_8hpp_source.html#l00141">141</a> of file <a class="el" href="protothread_2protothread_8hpp_source.html">protothread/protothread.hpp</a>.</p>

<p>References <a class="el" href="protothread_2protothread_8hpp_source.html#l00185">Invalid</a>, and <a class="el" href="protothread_2protothread_8hpp_source.html#l00191">ptState</a>.</p>

</div>
</div>
<a class="anchor" id="a74d6c935ce548a93698d902420cbaab9"></a><!-- doxytag: member="xpcc::pt::Protothread::isRunning" ref="a74d6c935ce548a93698d902420cbaab9" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classxpcc_1_1pt_1_1_protothread.html#a74d6c935ce548a93698d902420cbaab9">xpcc::pt::Protothread::isRunning</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="return"><dt><b>Returns:</b></dt><dd><code>true</code> if the protothread is running or waiting, <code>false</code> if it has ended or exited. </dd></dl>

<p>Definition at line <a class="el" href="protothread_2protothread_8hpp_source.html#l00153">153</a> of file <a class="el" href="protothread_2protothread_8hpp_source.html">protothread/protothread.hpp</a>.</p>

<p>References <a class="el" href="protothread_2protothread_8hpp_source.html#l00185">Invalid</a>, and <a class="el" href="protothread_2protothread_8hpp_source.html#l00191">ptState</a>.</p>

</div>
</div>
<a class="anchor" id="a640728df919edbefe4c9cefa5c8be90c"></a><!-- doxytag: member="xpcc::pt::Protothread::run" ref="a640728df919edbefe4c9cefa5c8be90c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classxpcc_1_1pt_1_1_protothread.html#a640728df919edbefe4c9cefa5c8be90c">xpcc::pt::Protothread::run</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Run next part of protothread or return immediately if it's still waiting. Returns <code>true</code> if protothread is still running, <code>false</code> if it has finished.</p>
<p>Implement this method in your <a class="el" href="classxpcc_1_1pt_1_1_protothread.html" title="A very lightweight, stackless thread.">Protothread</a> subclass.</p>
<dl class="warning"><dt><b>Warning:</b></dt><dd>This is method is not virtual, therefore you cannot access it through a Pointer to this class, but only directly from the subclass! This was done on purpose to keep the memory footprint low. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="protothread_2protothread_8hpp_source.html">protothread/protothread.hpp</a></li>
</ul>
</div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><b>xpcc</b>      </li>
      <li class="navelem"><b>pt</b>      </li>
      <li class="navelem"><a class="el" href="classxpcc_1_1pt_1_1_protothread.html">Protothread</a>      </li>
<hr class="footer" />
<address class="footer"><small>Generated on Mon Mar 5 2012 21:26:05 for XPCC by&nbsp;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.png" alt="doxygen" border="0" /></a> 1.7.6.1</small></address>

<!-- Piwik -->
<script type="text/javascript">
var pkBaseURL = (("https:" == document.location.protocol) ? "https://sourceforge.net/apps/piwik/xpcc/" : "http://sourceforge.net/apps/piwik/xpcc/");
document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
</script>

<script type="text/javascript">
try {
	var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 1);
	piwikTracker.trackPageView();
	piwikTracker.enableLinkTracking();
} catch( err ) {}
</script>
<noscript>
<p><img src="http://sourceforge.net/apps/piwik/xpcc/piwik.php?idsite=1" style="border:0" alt=""/></p>
</noscript>
<!-- End Piwik Tag -->

</body>
</html>
